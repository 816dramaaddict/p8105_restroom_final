---
title: "ADA Accessibility Prediction"
author: "Rita Wang"
date: "2024-12-07"
output: html_document
---

```{r default_setting, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
library(tidyverse)
library(sf)
library(purrr)
library(tidyverse)
library(dplyr)
library(janitor)
library(here)
library(reader)
library(nnet)
library(knitr)
```

```{r retreiving_cleaned_merged_data, echo = FALSE, message = FALSE, warning = FALSE}
restroom_subway_join = read_csv(here::here("./Data/cleaned_subway_restroom_data.csv"))
```


```{r predicting_ada_prep, echo = FALSE, message = FALSE, warning = FALSE}
# Cleaning merged data
restroom_subway_data = restroom_subway_join %>%
  dplyr::select(
    restroom_accessibility,
      # Dependent variable (ADA accessibility)
    restroom_latitude, restroom_longitude,
      # Restroom location features
    restroom_changing_stations, restroom_open,
      # Restroom other features
    station_latitude, station_longitude,
      # Subway station location features
    entrance_type, staffing
      # Subway station other features
  ) %>%
  drop_na() %>% 
  mutate(
    restroom_accessibility = as.factor(as.character(restroom_accessibility)), 
      # str(restroom_subway_data$restroom_accessibility)
        # confirming if restroom_accessibility is no longer ordered
    restroom_accessibility = relevel(restroom_accessibility, ref = "Not Accessible"),
    restroom_open = as.factor(restroom_open),
    entrance_type = as.factor(entrance_type),
    staffing = as.factor(staffing)
  )
```

```{r predicting_model, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
# Multinomial logistic regression model
ada_model = multinom(restroom_accessibility ~ restroom_latitude + restroom_longitude +
                       restroom_changing_stations + restroom_open +
                       station_latitude + station_longitude + 
                       entrance_type + staffing,
                     data = restroom_subway_data)

# Check the model summary
summary(ada_model)
```

**Model Summary Table**
```{r model_table, echo = FALSE, message = FALSE, warning = FALSE}
table = head(broom::tidy(ada_model), 31)
knitr::kable(table)
```

```{r testing_model, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
predicted_accessibility = predict(ada_model, restroom_subway_data)

# Confusion Matrix to evaluate the model's performance
table(Predicted = predicted_accessibility, Actual = restroom_subway_data$restroom_accessibility)

# Calculate accuracy
accuracy = mean(predicted_accessibility == restroom_subway_data$restroom_accessibility) * 100
accuracy = print(paste(accuracy, "%"))
```
**Accuracy:**

When testing the prediction model on the public restroom and train station data, there is an approximate of `r accuracy`.